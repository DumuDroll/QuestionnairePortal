<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<h:head>
    <title>Login page</title>
</h:head>
<h:body>
    <h:form id="form">
        <ui:insert name="divTop">
            <ui:include src="/secured/top.xhtml"/>
        </ui:insert>
        <p:toolbar>
            <p:toolbarGroup align="right">
                <p:commandButton value="ADD FIELD" icon="pi pi-plus" actionListener="#{fieldCreateMB.openNew}"
                                 update=":form:manage-field" onclick="PF('addFieldDialog').show()"
                                 styleClass="p-mr-2">
                    <p:resetInput target=":form:manage-field"/>
                </p:commandButton>
            </p:toolbarGroup>
        </p:toolbar>

        <p:dataTable id="fields" widgetVar="dtFields" var="field" value="#{fieldListMB.fields}"
                     reflow="true" styleClass="products-table"
                     selection="#{fieldCreateMB.selectedField}" paginator="true"
                     rows="5" rowSelectMode="add" paginatorPosition="bottom">
            <f:facet name="header">
                Fields
            </f:facet>
            <p:column headerText="Label">
                <h:outputText value="#{field.label}"/>
            </p:column>
            <p:column headerText="Type">
                <h:outputText value="#{field.type}"/>
            </p:column>
            <p:column headerText="Required">
                <h:outputText value="#{field.required}"/>
            </p:column>
            <p:column headerText="Is Active">
                <h:outputText value="#{field.active}"/>
            </p:column>
            <p:column>
                <p:commandButton icon="pi pi-pencil" update=":form:manage-field"
                                 oncomplete="PF('addFieldDialog').show()"
                                 styleClass="edit-button rounded-button ui-button-success" process="@this">
                    <f:setPropertyActionListener value="#{field}" target="#{fieldCreateMB.selectedField}"/>
                    <p:resetInput target=":form:manage-field"/>
                </p:commandButton>
                <p:commandButton class="ui-button-warning rounded-button" icon="pi pi-trash" process="@this"
                                 oncomplete="PF('deleteProductDialog').show()">
                    <f:setPropertyActionListener value="#{field}" target="#{fieldCreateMB.selectedField}"/>
                </p:commandButton>
            </p:column>
        </p:dataTable>

        <p:dialog widgetVar="addFieldDialog" header="Add Field" showEffect="fade" modal="true" responsive="true">
            <p:outputPanel id="manage-field" class="ui-fluid">
                <p:outputPanel rendered="#{not empty fieldCreateMB.selectedField}">
                    <p:outputLabel value="Label:"/>
                    <div class="p-field">
                        <p:inputText id="label" value="#{fieldCreateMB.selectedField.label}"/>
                    </div>
                    <div class="p-field">
                        <p:outputLabel value="Type:"/>
                        <p:selectOneMenu id="type" value="#{fieldCreateMB.selectedField.type}">
                            <f:selectItems value="#{fieldCreateMB.types}" var="type"
                                           itemValue="#{type}" itemLabel="#{type.label}"/>
                        </p:selectOneMenu>
                    </div>
                    <div class="p-field">
                        <p:outputLabel value="Oprions:"/>
                        <p:inputTextarea id="options" rows="6" cols="33"
                                         value="#{fieldCreateMB.selectedField.options}"/>
                    </div>
                    <div class="p-formgrid p-grid">
                        <div class="p-field p-col">
                            <p:outputLabel value="Required"/>
                            <p:selectBooleanCheckbox value="#{fieldCreateMB.selectedField.required}"/>
                        </div>
                        <div class="p-field p-col">
                            <p:outputLabel value="Active"/>
                            <p:selectBooleanCheckbox value="#{fieldCreateMB.selectedField.active}"/>
                        </div>
                    </div>
                </p:outputPanel>
            </p:outputPanel>
            <f:facet name="footer">
                <p:commandButton value="Cancel" icon="pi pi-times" onclick="PF('addFieldDialog').hide()"
                                 class="ui-button-secondary"/>
                <p:commandButton value="Save" icon="pi pi-check" actionListener="#{fieldCreateMB.save}"
                                 update=":form:manage-field" process=":form:manage-field @this"/>
            </f:facet>
        </p:dialog>
    </h:form>
</h:body>
</html>
